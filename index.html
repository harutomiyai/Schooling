<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理者サイト</title>
</head>
<body>
    <h1>出席フォーム管理者サイト</h1>
    <table>
        <thead>
            <tr>
                <th>クラス名</th>
                <th>日</th>
                <th>開始時間</th>
                <th>終了時間</th>
                <th>リンク</th>
            </tr>
        </thead>
        <tbody id="schedule-table">
            <!-- データがここに挿入されます -->
        </tbody>
    </table>

    <script>
        // 数字を漢字の曜日に変換する関数
        function convertDayToKanji(day) {
            const days = {
                '1': '月曜日',
                '2': '火曜日',
                '3': '水曜日',
                '4': '木曜日',
                '5': '金曜日',
                '6': '土曜日',
                '7': '日曜日'
            };
            return days[day] || '不明'; // 該当しない場合は "不明" を返す
        }
    
        // 複数の曜日を処理する関数
        function convertDaysToKanji(daysString) {
            const daysArray = daysString.split(','); // カンマで分割
            const kanjiDays = daysArray.map(day => convertDayToKanji(day.trim())); // トリムして変換
            return kanjiDays.join('、'); // 「、」で結合して返す
        }
    
        // 時間から秒を削除する関数
        function formatTime(time) {
            return time.replace(/:00$/, ''); // ":00" を削除
        }
    
        // PHPスクリプトからデータを取得して表示
        fetch('fetch_data.php')
            .then(response => response.json())
            .then(data => {
                const tableBody = document.getElementById('schedule-table');
                data.forEach(row => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${row.className}</td>
                        <td>${convertDaysToKanji(row.day)}</td>
                        <td>${formatTime(row.startTime)}</td>
                        <td>${formatTime(row.endTime)}</td>
                        <td><a href="${row.link}" target="_blank">${row.link}</a></td>
                    `;
                    tableBody.appendChild(tr);
                });
            })
            .catch(error => console.error('データ取得エラー:', error));
    </script>    
</body>
</html>
